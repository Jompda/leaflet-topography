(()=>{"use strict";var a={},e={service:"mapbox",priority:"speed",scale:15,tileCache:a};var t=window.L;console.log("Leaflet",t);var r={getTopography:async function(a,t){var r=Object.assign(e,t),{map:o,scale:n,priority:i,token:s,tileCache:c,saveTile:p}=r;if(!o)throw new Error("Map instance must be passed as option to leaflet-topography config or options");if(!s)throw new Error("Token required in leaflet-topography config / options");var g=p||((a,e)=>c[a]=e);async function l(a){var e,{X:t,Y:r,Z:o}=(e=a,{X:Math.floor(e.x/256),Y:Math.floor(e.y/256),Z:n}),p=c[`X${t}Y${r}Z${o}`];if(!p)return console.log("theres no tile"),await async function(a){var{X:e,Y:t,Z:r}=a,o=`https://api.mapbox.com/v4/mapbox.terrain-rgb/${r}/${e}/${t}.pngraw?access_token=${s}`,n=`X${e}Y${t}Z${r}`,c=document.createElement("canvas");c.width=c.height=256;var p,l=c.getContext("2d");await(p=o,new Promise(((a,e)=>{var t=new Image;t.crossOrigin="*",t.addEventListener("load",(()=>a(t))),t.addEventListener("error",(a=>e(a))),t.src=p}))).then((a=>{if("speed"===i){l.drawImage(a,0,0,256,256);var e=l.getImageData(0,0,256,256);g(n,e)}else createImageBitmap(a,0,0,256,256).then((a=>g(n,a)))}))}({X:t,Y:r,Z:o}),void l(a);var h,v,d,w,f,m={x:Math.floor(a.x)-256*t,y:Math.floor(a.y)-256*r};if("speed"===i)d=m.x,w=4*(m.y*(v=p).width+d),h={R:(f=v.data)[w],G:f[w+1],B:f[w+2],A:f[w+3]};else{var y=document.createElement("canvas").getContext("2d");y.drawImage(p,0,0);var u=y.getImageData(m.x,m.y,1,1).data;h={R:u[0],G:u[1],B:u[2],A:u[3]}}var{R:x,G:M,B:$}=h;return.1*(256*x*256+256*M+$)-1e4}var h=o.project(a,n),v={...h,y:h.y-2},d={...h,y:h.y+2},w={...h,x:h.x+2},f={...h,x:h.x-2},m=o.unproject(v,n),y=o.unproject(d,n),u=o.unproject(w,n),x=o.unproject(f,n),M=await l(h),$=await l(v),I=await l(d),b=await l(w),j=await l(f),E=o.distance(u,x),X=o.distance(m,y),Y=(b-j)/E,Z=($-I)/X;return{elevation:M,slope:Math.atan(Math.sqrt(Y**2+Z**2))*(180/Math.PI),aspect:0!==E?90-Math.atan2(Z,Y)*(180/Math.PI):90-90*(X>0?1:-1)}},tileCache:a,_config:e,config:a=>{var t=Object.assign(e,a);return e=t}};t.Topography=r})();